@using BuilderPulsePro.Builders
@using Volo.Abp.Guids
@inherits BuilderPulseProComponentBase
@inject IGuidGenerator GuidGenerator

<DataGrid @ref="gridRef" TItem="CreateUpdateBuilderLocationDto" Data="Locations" Striped RowSelectable="@(x => false)" Editable>
    <DataGridColumns>
        <DataGridColumn Field="@nameof(CreateUpdateBuilderLocationDto.Name)" Caption="Name"></DataGridColumn>
        <DataGridColumn Field="@nameof(CreateUpdateBuilderLocationDto.Street1)" Caption="Street 1"></DataGridColumn>
        <DataGridEntityActionsColumn>
            <DisplayTemplate>
                <Button Color="Color.Primary" Clicked="() => ShowLocationModal(context)"><Icon Name="IconName.Edit"></Icon></Button>
                <Button Color="Color.Danger" Clicked="() => DeleteLocation(context)"><Icon Name="IconName.Delete"></Icon></Button>
            </DisplayTemplate>
        </DataGridEntityActionsColumn>
    </DataGridColumns>
</DataGrid>
<Button Color="Color.Primary" Clicked="() => ShowLocationModal(new CreateUpdateBuilderLocationDto())">Add Location</Button>
<Modal @ref="LocationModal">
    <ModalContent Size="ModalSize.Large">
        <ModalHeader>
            <ModalTitle>
                Add Location
            </ModalTitle>
            <CloseButton />
        </ModalHeader>
        <ModalBody>
            <Validations @ref="@Validator" Mode="ValidationMode.Manual">
                <Validation Validator="ValidateLocation">
                    <LocationSelector Location="CurrentLocation" ShowExtraFields="true" OnLocationSelected="HandleLocationSelected" />
                    <Blazorise.ValidationSummary Label="A Location must have a Name and Address.">
                    </Blazorise.ValidationSummary>
                </Validation>
            </Validations>
        </ModalBody>
        <ModalFooter>
            <Button Color="Color.Light" Clicked="CloseLocationModal">Cancel</Button>
            <Button Color="Color.Primary" Clicked="SaveLocation">Save</Button>
        </ModalFooter>
    </ModalContent>
</Modal>